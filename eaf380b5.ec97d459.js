(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{189:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return b}));var a=n(2),r=n(9),o=(n(0),n(196)),i={id:"deployment",title:"Deployment"},l={id:"general/deployment",isDocsHomePage:!1,title:"Deployment",description:"Heroku",source:"@site/docs/general/deployment.md",permalink:"/docs/general/deployment",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/general/deployment.md",sidebar:"someSidebar",previous:{title:"Server Configurations",permalink:"/docs/general/server-configs"},next:{title:"Debugging",permalink:"/docs/general/debugging"}},c=[{value:"Heroku",id:"heroku",children:[{value:"Easy 3-Step Deployment Process",id:"easy-3-step-deployment-process",children:[]}]},{value:"AWS S3",id:"aws-s3",children:[{value:"Easy 7-Step Deployment Process",id:"easy-7-step-deployment-process",children:[]}]},{value:"Deploying in a subfolder of an existing server",id:"deploying-in-a-subfolder-of-an-existing-server",children:[]},{value:"AWS Elastic Beanstalk",id:"aws-elastic-beanstalk",children:[{value:"Pre-requisites",id:"pre-requisites",children:[]},{value:"Configuration",id:"configuration",children:[]}]}],p={rightToc:c};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"heroku"},"Heroku"),Object(o.b)("h3",{id:"easy-3-step-deployment-process"},"Easy 3-Step Deployment Process"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 1:")," Create a ",Object(o.b)("em",{parentName:"p"},"Procfile")," with the following line: ",Object(o.b)("inlineCode",{parentName:"p"},"web: npm run start:prod"),". We do this because Heroku runs ",Object(o.b)("inlineCode",{parentName:"p"},"npm run start")," by default, so we need this setting to override the default run command."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 2:")," Install the Node.js buildpack for your Heroku app by running the following command: ",Object(o.b)("inlineCode",{parentName:"p"},"heroku buildpacks:set https://github.com/heroku/heroku-buildpack-nodejs#v133 -a [your app name]"),". Make sure to replace ",Object(o.b)("inlineCode",{parentName:"p"},"#v133")," with whatever the latest buildpack is, which you can ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/heroku/heroku-buildpack-nodejs/releases"}),"find here"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 3:")," Follow the standard Heroku deploy process:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"git add .")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"git commit -m 'Made some epic changes as per usual'")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"git push heroku master"))),Object(o.b)("h2",{id:"aws-s3"},"AWS S3"),Object(o.b)("h3",{id:"easy-7-step-deployment-process"},"Easy 7-Step Deployment Process"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 1:")," Run ",Object(o.b)("inlineCode",{parentName:"p"},"npm install")," to install dependencies, then ",Object(o.b)("inlineCode",{parentName:"p"},"npm run build")," to create the ",Object(o.b)("inlineCode",{parentName:"p"},"./build")," folder."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 2:")," Navigate to ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://aws.amazon.com/s3"}),"AWS S3")," and login (or sign up if you don't have an account). Click on ",Object(o.b)("inlineCode",{parentName:"p"},"Services")," followed by ",Object(o.b)("inlineCode",{parentName:"p"},"S3")," in the dropdown."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 3:")," Click on ",Object(o.b)("inlineCode",{parentName:"p"},"Create Bucket")," and fill out both your ",Object(o.b)("inlineCode",{parentName:"p"},"Bucket Name")," and ",Object(o.b)("inlineCode",{parentName:"p"},"Region")," (for the USA we recommend ",Object(o.b)("inlineCode",{parentName:"p"},"US Standard"),"). Click ",Object(o.b)("inlineCode",{parentName:"p"},"Create")," to create your bucket."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 4:")," Open the ",Object(o.b)("inlineCode",{parentName:"p"},"Permissions")," accordion on the right (under the ",Object(o.b)("inlineCode",{parentName:"p"},"Properties")," tab) after selecting your new bucket. Click ",Object(o.b)("inlineCode",{parentName:"p"},"Add more permissions"),", set the ",Object(o.b)("inlineCode",{parentName:"p"},"Grantee")," to ",Object(o.b)("inlineCode",{parentName:"p"},"Everyone")," (or whoever you want to be able to access the website), and give them ",Object(o.b)("inlineCode",{parentName:"p"},"View Permissions"),". Click ",Object(o.b)("inlineCode",{parentName:"p"},"Save"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 5:")," Click on the ",Object(o.b)("inlineCode",{parentName:"p"},"Static Website Hosting")," accordion where you should see the URL (or ",Object(o.b)("em",{parentName:"p"},"endpoint"),") of your website (ie. example.s3-website-us-east-1.amazonaws.com). Click ",Object(o.b)("inlineCode",{parentName:"p"},"Enable website hosting")," and fill in both the ",Object(o.b)("inlineCode",{parentName:"p"},"Index document")," and ",Object(o.b)("inlineCode",{parentName:"p"},"Error document")," input fields with ",Object(o.b)("inlineCode",{parentName:"p"},"index.html"),". Click ",Object(o.b)("inlineCode",{parentName:"p"},"Save"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 6:")," Click on your new S3 bucket on the left to open the bucket. Click ",Object(o.b)("inlineCode",{parentName:"p"},"Upload")," and select all the files within your ",Object(o.b)("inlineCode",{parentName:"p"},"./build")," folder. Click ",Object(o.b)("inlineCode",{parentName:"p"},"Start Upload"),". Once the files are done, select all of the files, right-click on the selected files (or click on the ",Object(o.b)("inlineCode",{parentName:"p"},"Actions")," button) and select ",Object(o.b)("inlineCode",{parentName:"p"},"Make Public"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 7:")," Click on the ",Object(o.b)("inlineCode",{parentName:"p"},"Properties")," tab, open ",Object(o.b)("inlineCode",{parentName:"p"},"Static Website Hosting"),", and click on the ",Object(o.b)("em",{parentName:"p"},"Endpoint")," link. The app should be running on that URL."),Object(o.b)("h2",{id:"deploying-in-a-subfolder-of-an-existing-server"},"Deploying in a subfolder of an existing server"),Object(o.b)("p",null,"Suppose you want users to access the app on ",Object(o.b)("inlineCode",{parentName:"p"},"https://<host>/web-app")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 1:")," Configure webpack to inject necessary environment variables into the app"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Changes below are made to ",Object(o.b)("inlineCode",{parentName:"li"},"internals/webpack/webpack.base.babel.js")," file.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-diff"}),"+ const BUILD_FOLDER_PATH = process.env.BUILD_FOLDER_PATH || 'build';\n+ const PUBLIC_PATH = process.env.PUBLIC_PATH || '/';\n")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-diff"}),"- path: path.resolve(process.cwd(), 'build'),\n- publicPath: '/',\n+ path: path.resolve(process.cwd(), BUILD_FOLDER_PATH),\n+ publicPath: PUBLIC_PATH,\n")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-diff"}),"# inside EnvironmentPlugin\n+    PUBLIC_PATH: '/',\n")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 2:")," add ",Object(o.b)("inlineCode",{parentName:"p"},"basename")," to the history"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Changes below are made to ",Object(o.b)("inlineCode",{parentName:"li"},"app/utils/history.js")," file.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-diff"}),"- const history = createHistory();\n+ const basename = process.env.PUBLIC_PATH;\n+ const history = createHistory({ basename });\n")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 3:")," Run ",Object(o.b)("inlineCode",{parentName:"p"},"PUBLIC_PATH='/web-app/' BUILD_FOLDER_PATH='build/web-app' npm run build"),", to save production build inside ",Object(o.b)("inlineCode",{parentName:"p"},"./build/web-app")," folder."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 4:")," Upload/Place the created ",Object(o.b)("inlineCode",{parentName:"p"},"web-app")," folder in your server's web-root folder"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Endpoint")," The app should be accessible on ",Object(o.b)("inlineCode",{parentName:"p"},"https://<host>/web-app"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"NOTE")," that this has been tested on both APACHE and NGINX servers."),Object(o.b)("h2",{id:"aws-elastic-beanstalk"},"AWS Elastic Beanstalk"),Object(o.b)("p",null,"Please refer to to issue ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/react-boilerplate/react-boilerplate/issues/2566"}),"#2566")," for more explanation."),Object(o.b)("h3",{id:"pre-requisites"},"Pre-requisites"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Create an account on ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://console.aws.amazon.com/"}),"AWS console")),Object(o.b)("li",{parentName:"ol"},"Install EB CLI (",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-install.html?icmpid=docs_elasticbeanstalk_console#eb-cli3-install.cli-only"}),"AWS documentation"),")"),Object(o.b)("li",{parentName:"ol"},"Create your ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-configuration.html#eb-cli3-profile"}),"AWS EB profile"),".\nIn case you are using a continous deployment tool, you can create another user\nfor your CD tool as well."),Object(o.b)("li",{parentName:"ol"},"Create your Elastic Beanstalk ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/applications.html"}),"application")," and ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.managing.html"}),"environment")," (either via CLI or web console)"),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-configuration.html"}),"Configure your EB CLI"),". You should have a ",Object(o.b)("inlineCode",{parentName:"li"},".elasticbeanstalk/config.yml")," if properly configured")),Object(o.b)("h3",{id:"configuration"},"Configuration"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 1:")," Add AWS EB start scripts in ",Object(o.b)("em",{parentName:"p"},"package.json"),": ",Object(o.b)("inlineCode",{parentName:"p"},'"aws-eb:prod": "npm run build && npm run start:prod"')),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 2:")," Create a ",Object(o.b)("inlineCode",{parentName:"p"},".ebextensions/aws.config")," file:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"# Check https://github.com/react-boilerplate/react-boilerplate/issues/2566 for details\noption_settings:\n  aws:elasticbeanstalk:container:nodejs:\n    NodeCommand: 'npm run aws-eb:prod'\n  aws:elasticbeanstalk:application:environment:\n    NPM_USE_PRODUCTION: false\n")),Object(o.b)("p",null,"In the likely case of multiple environment, remove the ",Object(o.b)("inlineCode",{parentName:"p"},"NodeCommand")," entry and\nmanually configure it per environment in the web console: ",Object(o.b)("em",{parentName:"p"},"Configuration > Software > Node command"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 3:")," Create a ",Object(o.b)("inlineCode",{parentName:"p"},".npmrc")," file:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"# Check https://github.com/react-boilerplate/react-boilerplate/issues/2566 for details\nunsafe-perm=true\n")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Step 4:")," commit your changes and deploy via EB CLI:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"eb deploy {target environment name}\n")))}b.isMDXComponent=!0},196:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=r.a.createContext({}),b=function(e){var t=r.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=b(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),s=b(n),d=a,u=s["".concat(i,".").concat(d)]||s[d]||m[d]||o;return n?r.a.createElement(u,l(l({ref:t},p),{},{components:n})):r.a.createElement(u,l({ref:t},p))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);